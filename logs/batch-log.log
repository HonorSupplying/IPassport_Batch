2025-03-04T08:51:30.757+07:00  INFO 2076 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : Starting IpassportbatchApplication using Java 23.0.1 with PID 2076 (D:\Krungsri\ipassport-batch\target\classes started by User in D:\Krungsri\ipassport-batch)
2025-03-04T08:51:30.762+07:00  INFO 2076 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : No active profile set, falling back to 1 default profile: "default"
2025-03-04T08:51:31.175+07:00  INFO 2076 --- [ipassportbatch] [main] o.s.b.c.c.annotation.BatchRegistrar      : Bean jobLauncher already defined in the application context, skipping the registration of a jobLauncher
2025-03-04T08:51:31.177+07:00  INFO 2076 --- [ipassportbatch] [main] o.s.b.c.c.annotation.BatchRegistrar      : Finished Spring Batch infrastructure beans configuration in 9 ms.
2025-03-04T08:51:31.310+07:00  INFO 2076 --- [ipassportbatch] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-04T08:51:31.328+07:00  INFO 2076 --- [ipassportbatch] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 11 ms. Found 0 JPA repository interfaces.
2025-03-04T08:51:31.736+07:00  INFO 2076 --- [ipassportbatch] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-03-04T08:51:32.053+07:00  INFO 2076 --- [ipassportbatch] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: da49b8e4-edfb-4af3-913d-80fa7b43c2ca
2025-03-04T08:51:32.055+07:00  INFO 2076 --- [ipassportbatch] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-03-04T08:51:32.119+07:00  INFO 2076 --- [ipassportbatch] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-04T08:51:32.159+07:00  INFO 2076 --- [ipassportbatch] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.8.Final
2025-03-04T08:51:32.204+07:00  INFO 2076 --- [ipassportbatch] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-03-04T08:51:32.481+07:00  INFO 2076 --- [ipassportbatch] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-04T08:51:32.536+07:00  WARN 2076 --- [ipassportbatch] [main] org.hibernate.orm.deprecation            : HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-03-04T08:51:32.549+07:00  INFO 2076 --- [ipassportbatch] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 16.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-03-04T08:51:32.874+07:00  INFO 2076 --- [ipassportbatch] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-03-04T08:51:32.880+07:00  INFO 2076 --- [ipassportbatch] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-04T08:51:32.947+07:00  INFO 2076 --- [ipassportbatch] [main] o.s.b.c.r.s.JobRepositoryFactoryBean     : No database type set, using meta data indicating: SQLSERVER
2025-03-04T08:51:32.998+07:00  INFO 2076 --- [ipassportbatch] [main] o.s.b.c.l.s.TaskExecutorJobLauncher      : No TaskExecutor has been set, defaulting to synchronous executor.
2025-03-04T08:51:33.037+07:00  INFO 2076 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:51:33.042+07:00  INFO 2076 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:51:33.043+07:00  WARN 2076 --- [ipassportbatch] [main] s.c.a.AnnotationConfigApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'batchScheduler': Unsatisfied dependency expressed through method 'setClearCustomerData' parameter 0: Error creating bean with name 'clearCustomerData' defined in class path resource [com/krungsri/ipassportbatch/job/ClearCustomerDataJob.class]: Unsatisfied dependency expressed through method 'clearCustomerData' parameter 3: Error creating bean with name 'markExpireBeforeClearStep' defined in class path resource [com/krungsri/ipassportbatch/job/ClearCustomerDataJob.class]: Unsatisfied dependency expressed through method 'markExpireBeforeClearStep' parameter 2: No qualifying bean of type 'com.krungsri.ipassportbatch.tasklet.MarkExpireTransactionBeforeDailyClearTasklet' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}
2025-03-04T08:51:33.044+07:00  INFO 2076 --- [ipassportbatch] [main] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-04T08:51:33.047+07:00  INFO 2076 --- [ipassportbatch] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-03-04T08:51:33.053+07:00  INFO 2076 --- [ipassportbatch] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-03-04T08:51:33.060+07:00  INFO 2076 --- [ipassportbatch] [main] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-03-04T08:51:33.086+07:00 ERROR 2076 --- [ipassportbatch] [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

Parameter 2 of method markExpireBeforeClearStep in com.krungsri.ipassportbatch.job.ClearCustomerDataJob required a bean of type 'com.krungsri.ipassportbatch.tasklet.MarkExpireTransactionBeforeDailyClearTasklet' that could not be found.


Action:

Consider defining a bean of type 'com.krungsri.ipassportbatch.tasklet.MarkExpireTransactionBeforeDailyClearTasklet' in your configuration.

2025-03-04T08:52:11.721+07:00  INFO 11232 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : Starting IpassportbatchApplication using Java 23.0.1 with PID 11232 (D:\Krungsri\ipassport-batch\target\classes started by User in D:\Krungsri\ipassport-batch)
2025-03-04T08:52:11.722+07:00  INFO 11232 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : No active profile set, falling back to 1 default profile: "default"
2025-03-04T08:52:12.096+07:00  INFO 11232 --- [ipassportbatch] [main] o.s.b.c.c.annotation.BatchRegistrar      : Bean jobLauncher already defined in the application context, skipping the registration of a jobLauncher
2025-03-04T08:52:12.097+07:00  INFO 11232 --- [ipassportbatch] [main] o.s.b.c.c.annotation.BatchRegistrar      : Finished Spring Batch infrastructure beans configuration in 7 ms.
2025-03-04T08:52:12.216+07:00  INFO 11232 --- [ipassportbatch] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-04T08:52:12.232+07:00  INFO 11232 --- [ipassportbatch] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 9 ms. Found 0 JPA repository interfaces.
2025-03-04T08:52:12.633+07:00  INFO 11232 --- [ipassportbatch] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-03-04T08:52:12.942+07:00  INFO 11232 --- [ipassportbatch] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: 685e8009-5851-4109-9c25-0cfe609da8a1
2025-03-04T08:52:12.943+07:00  INFO 11232 --- [ipassportbatch] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-03-04T08:52:13.021+07:00  INFO 11232 --- [ipassportbatch] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-04T08:52:13.076+07:00  INFO 11232 --- [ipassportbatch] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.8.Final
2025-03-04T08:52:13.106+07:00  INFO 11232 --- [ipassportbatch] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-03-04T08:52:13.345+07:00  INFO 11232 --- [ipassportbatch] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-04T08:52:13.398+07:00  WARN 11232 --- [ipassportbatch] [main] org.hibernate.orm.deprecation            : HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-03-04T08:52:13.411+07:00  INFO 11232 --- [ipassportbatch] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 16.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-03-04T08:52:13.687+07:00  INFO 11232 --- [ipassportbatch] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-03-04T08:52:13.692+07:00  INFO 11232 --- [ipassportbatch] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-04T08:52:13.738+07:00  INFO 11232 --- [ipassportbatch] [main] o.s.b.c.r.s.JobRepositoryFactoryBean     : No database type set, using meta data indicating: SQLSERVER
2025-03-04T08:52:13.782+07:00  INFO 11232 --- [ipassportbatch] [main] o.s.b.c.l.s.TaskExecutorJobLauncher      : No TaskExecutor has been set, defaulting to synchronous executor.
2025-03-04T08:52:13.816+07:00  INFO 11232 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:13.822+07:00  INFO 11232 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:13.825+07:00  INFO 11232 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:13.835+07:00  INFO 11232 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:13.839+07:00  INFO 11232 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:13.840+07:00  INFO 11232 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:13.844+07:00  INFO 11232 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:13.845+07:00  INFO 11232 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:13.848+07:00  INFO 11232 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:13.850+07:00  INFO 11232 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:13.853+07:00  INFO 11232 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:14.067+07:00  INFO 11232 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : Started IpassportbatchApplication in 2.786 seconds (process running for 3.117)
2025-03-04T08:52:21.351+07:00  INFO 11232 --- [ipassportbatch] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-04T08:52:21.353+07:00  INFO 11232 --- [ipassportbatch] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-03-04T08:52:21.356+07:00  INFO 11232 --- [ipassportbatch] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-03-04T08:52:32.119+07:00  INFO 16880 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : Starting IpassportbatchApplication using Java 23.0.1 with PID 16880 (D:\Krungsri\ipassport-batch\target\classes started by User in D:\Krungsri\ipassport-batch)
2025-03-04T08:52:32.121+07:00  INFO 16880 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : No active profile set, falling back to 1 default profile: "default"
2025-03-04T08:52:32.482+07:00  INFO 16880 --- [ipassportbatch] [main] o.s.b.c.c.annotation.BatchRegistrar      : Bean jobLauncher already defined in the application context, skipping the registration of a jobLauncher
2025-03-04T08:52:32.483+07:00  INFO 16880 --- [ipassportbatch] [main] o.s.b.c.c.annotation.BatchRegistrar      : Finished Spring Batch infrastructure beans configuration in 6 ms.
2025-03-04T08:52:32.607+07:00  INFO 16880 --- [ipassportbatch] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-04T08:52:32.627+07:00  INFO 16880 --- [ipassportbatch] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 11 ms. Found 0 JPA repository interfaces.
2025-03-04T08:52:33.043+07:00  INFO 16880 --- [ipassportbatch] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-03-04T08:52:33.351+07:00  INFO 16880 --- [ipassportbatch] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: 835cf3af-2a26-4104-b4bc-692863a54469
2025-03-04T08:52:33.352+07:00  INFO 16880 --- [ipassportbatch] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-03-04T08:52:33.420+07:00  INFO 16880 --- [ipassportbatch] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-04T08:52:33.451+07:00  INFO 16880 --- [ipassportbatch] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.8.Final
2025-03-04T08:52:33.496+07:00  INFO 16880 --- [ipassportbatch] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-03-04T08:52:33.745+07:00  INFO 16880 --- [ipassportbatch] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-04T08:52:33.798+07:00  WARN 16880 --- [ipassportbatch] [main] org.hibernate.orm.deprecation            : HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-03-04T08:52:33.810+07:00  INFO 16880 --- [ipassportbatch] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 16.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-03-04T08:52:34.125+07:00  INFO 16880 --- [ipassportbatch] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-03-04T08:52:34.131+07:00  INFO 16880 --- [ipassportbatch] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-04T08:52:34.180+07:00  INFO 16880 --- [ipassportbatch] [main] o.s.b.c.r.s.JobRepositoryFactoryBean     : No database type set, using meta data indicating: SQLSERVER
2025-03-04T08:52:34.225+07:00  INFO 16880 --- [ipassportbatch] [main] o.s.b.c.l.s.TaskExecutorJobLauncher      : No TaskExecutor has been set, defaulting to synchronous executor.
2025-03-04T08:52:34.260+07:00  INFO 16880 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:34.265+07:00  INFO 16880 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:34.268+07:00  INFO 16880 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:34.276+07:00  INFO 16880 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:34.280+07:00  INFO 16880 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:34.282+07:00  INFO 16880 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:34.286+07:00  INFO 16880 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:34.288+07:00  INFO 16880 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:34.290+07:00  INFO 16880 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:34.292+07:00  INFO 16880 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:34.295+07:00  INFO 16880 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:52:34.488+07:00  INFO 16880 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : Started IpassportbatchApplication in 2.825 seconds (process running for 3.172)
2025-03-04T08:53:00.104+07:00 ERROR 16880 --- [ipassportbatch] [scheduling-1] o.s.s.s.TaskUtils$LoggingErrorHandler    : Unexpected error occurred in scheduled task

org.springframework.jdbc.UncategorizedSQLException: PreparedStatementCallback; uncategorized SQLException for SQL [SELECT JOB_INSTANCE_ID, JOB_NAME
FROM BATCH_JOB_INSTANCE
WHERE JOB_NAME = ?
 and JOB_KEY = ?]; SQL state [S0002]; error code [208]; Invalid object name 'BATCH_JOB_INSTANCE'.
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1557) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:677) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:723) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:754) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:767) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:825) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.batch.core.repository.dao.JdbcJobInstanceDao.getJobInstance(JdbcJobInstanceDao.java:183) ~[spring-batch-core-5.2.1.jar:5.2.1]
	at org.springframework.batch.core.repository.support.SimpleJobRepository.getLastJobExecution(SimpleJobRepository.java:299) ~[spring-batch-core-5.2.1.jar:5.2.1]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.3.jar:6.2.3]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.3.jar:6.2.3]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.3.jar:6.2.3]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380) ~[spring-tx-6.2.3.jar:6.2.3]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.2.3.jar:6.2.3]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.3.jar:6.2.3]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.3.jar:6.2.3]
	at jdk.proxy2/jdk.proxy2.$Proxy80.getLastJobExecution(Unknown Source) ~[na:na]
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109) ~[spring-batch-core-5.2.1.jar:5.2.1]
	at com.krungsri.ipassportbatch.scheduler.BatchScheduler.scheduleClearCustomerData(BatchScheduler.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124) ~[spring-context-6.2.3.jar:6.2.3]
	at io.micrometer.observation.Observation.observe(Observation.java:498) ~[micrometer-observation-1.14.4.jar:1.14.4]
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:96) ~[spring-context-6.2.3.jar:6.2.3]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1575) ~[na:na]
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: Invalid object name 'BATCH_JOB_INSTANCE'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:270) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1735) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.doExecutePreparedStatement(SQLServerPreparedStatement.java:675) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement$PrepStmtExecCmd.doExecute(SQLServerPreparedStatement.java:594) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4391) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:276) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:246) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.executeQuery(SQLServerPreparedStatement.java:509) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52) ~[HikariCP-5.1.0.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java) ~[HikariCP-5.1.0.jar:na]
	at org.springframework.jdbc.core.JdbcTemplate$1.doInPreparedStatement(JdbcTemplate.java:732) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:658) ~[spring-jdbc-6.2.3.jar:6.2.3]
	... 33 common frames omitted

2025-03-04T08:53:00.114+07:00 ERROR 16880 --- [ipassportbatch] [scheduling-1] o.s.s.s.TaskUtils$LoggingErrorHandler    : Unexpected error occurred in scheduled task

org.springframework.jdbc.UncategorizedSQLException: PreparedStatementCallback; uncategorized SQLException for SQL [SELECT JOB_INSTANCE_ID, JOB_NAME
FROM BATCH_JOB_INSTANCE
WHERE JOB_NAME = ?
 and JOB_KEY = ?]; SQL state [S0002]; error code [208]; Invalid object name 'BATCH_JOB_INSTANCE'.
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1557) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:677) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:723) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:754) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:767) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:825) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.batch.core.repository.dao.JdbcJobInstanceDao.getJobInstance(JdbcJobInstanceDao.java:183) ~[spring-batch-core-5.2.1.jar:5.2.1]
	at org.springframework.batch.core.repository.support.SimpleJobRepository.getLastJobExecution(SimpleJobRepository.java:299) ~[spring-batch-core-5.2.1.jar:5.2.1]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.3.jar:6.2.3]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.3.jar:6.2.3]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.3.jar:6.2.3]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380) ~[spring-tx-6.2.3.jar:6.2.3]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.2.3.jar:6.2.3]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.3.jar:6.2.3]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.3.jar:6.2.3]
	at jdk.proxy2/jdk.proxy2.$Proxy80.getLastJobExecution(Unknown Source) ~[na:na]
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109) ~[spring-batch-core-5.2.1.jar:5.2.1]
	at com.krungsri.ipassportbatch.scheduler.BatchScheduler.scheduleMarkExpiredTransaction(BatchScheduler.java:58) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124) ~[spring-context-6.2.3.jar:6.2.3]
	at io.micrometer.observation.Observation.observe(Observation.java:498) ~[micrometer-observation-1.14.4.jar:1.14.4]
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:96) ~[spring-context-6.2.3.jar:6.2.3]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1575) ~[na:na]
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: Invalid object name 'BATCH_JOB_INSTANCE'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:270) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1735) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.doExecutePreparedStatement(SQLServerPreparedStatement.java:675) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement$PrepStmtExecCmd.doExecute(SQLServerPreparedStatement.java:594) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4391) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:276) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:246) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.executeQuery(SQLServerPreparedStatement.java:509) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52) ~[HikariCP-5.1.0.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java) ~[HikariCP-5.1.0.jar:na]
	at org.springframework.jdbc.core.JdbcTemplate$1.doInPreparedStatement(JdbcTemplate.java:732) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:658) ~[spring-jdbc-6.2.3.jar:6.2.3]
	... 33 common frames omitted

2025-03-04T08:53:05.335+07:00  INFO 16880 --- [ipassportbatch] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-04T08:53:05.337+07:00  INFO 16880 --- [ipassportbatch] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-03-04T08:53:05.342+07:00  INFO 16880 --- [ipassportbatch] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-03-04T08:53:15.319+07:00  INFO 1348 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : Starting IpassportbatchApplication using Java 23.0.1 with PID 1348 (D:\Krungsri\ipassport-batch\target\classes started by User in D:\Krungsri\ipassport-batch)
2025-03-04T08:53:15.321+07:00  INFO 1348 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : No active profile set, falling back to 1 default profile: "default"
2025-03-04T08:53:15.753+07:00  WARN 1348 --- [ipassportbatch] [main] s.c.a.AnnotationConfigApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.support.BeanDefinitionOverrideException: Invalid bean definition with name 'jobLauncher' defined in class path resource [org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration$SpringBootBatchConfiguration.class]: Cannot register bean definition [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; fallback=false; factoryBeanName=org.springframework.boot.autoconfigure.batch.BatchAutoConfiguration$SpringBootBatchConfiguration; factoryMethodName=jobLauncher; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration$SpringBootBatchConfiguration.class]] for bean 'jobLauncher' since there is already [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; fallback=false; factoryBeanName=batchConfiguration; factoryMethodName=jobLauncher; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [com/krungsri/ipassportbatch/config/BatchConfiguration.class]] bound.
2025-03-04T08:53:15.759+07:00  INFO 1348 --- [ipassportbatch] [main] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-03-04T08:53:15.777+07:00 ERROR 1348 --- [ipassportbatch] [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

The bean 'jobLauncher', defined in class path resource [org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration$SpringBootBatchConfiguration.class], could not be registered. A bean with that name has already been defined in class path resource [com/krungsri/ipassportbatch/config/BatchConfiguration.class] and overriding is disabled.

Action:

Consider renaming one of the beans or enabling overriding by setting spring.main.allow-bean-definition-overriding=true

2025-03-04T08:53:29.227+07:00  INFO 6348 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : Starting IpassportbatchApplication using Java 23.0.1 with PID 6348 (D:\Krungsri\ipassport-batch\target\classes started by User in D:\Krungsri\ipassport-batch)
2025-03-04T08:53:29.228+07:00  INFO 6348 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : No active profile set, falling back to 1 default profile: "default"
2025-03-04T08:53:29.639+07:00  WARN 6348 --- [ipassportbatch] [main] s.c.a.AnnotationConfigApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.support.BeanDefinitionOverrideException: Invalid bean definition with name 'jobLauncher' defined in class path resource [org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration$SpringBootBatchConfiguration.class]: Cannot register bean definition [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; fallback=false; factoryBeanName=org.springframework.boot.autoconfigure.batch.BatchAutoConfiguration$SpringBootBatchConfiguration; factoryMethodName=jobLauncher; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration$SpringBootBatchConfiguration.class]] for bean 'jobLauncher' since there is already [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; fallback=false; factoryBeanName=batchConfiguration; factoryMethodName=jobLauncher; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [com/krungsri/ipassportbatch/config/BatchConfiguration.class]] bound.
2025-03-04T08:53:29.650+07:00  INFO 6348 --- [ipassportbatch] [main] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-03-04T08:53:29.663+07:00 ERROR 6348 --- [ipassportbatch] [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

The bean 'jobLauncher', defined in class path resource [org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration$SpringBootBatchConfiguration.class], could not be registered. A bean with that name has already been defined in class path resource [com/krungsri/ipassportbatch/config/BatchConfiguration.class] and overriding is disabled.

Action:

Consider renaming one of the beans or enabling overriding by setting spring.main.allow-bean-definition-overriding=true

2025-03-04T08:54:11.944+07:00  INFO 14968 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : Starting IpassportbatchApplication using Java 23.0.1 with PID 14968 (D:\Krungsri\ipassport-batch\target\classes started by User in D:\Krungsri\ipassport-batch)
2025-03-04T08:54:11.950+07:00  INFO 14968 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : No active profile set, falling back to 1 default profile: "default"
2025-03-04T08:54:12.436+07:00  WARN 14968 --- [ipassportbatch] [main] s.c.a.AnnotationConfigApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.support.BeanDefinitionOverrideException: Invalid bean definition with name 'jobLauncher' defined in class path resource [org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration$SpringBootBatchConfiguration.class]: Cannot register bean definition [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; fallback=false; factoryBeanName=org.springframework.boot.autoconfigure.batch.BatchAutoConfiguration$SpringBootBatchConfiguration; factoryMethodName=jobLauncher; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration$SpringBootBatchConfiguration.class]] for bean 'jobLauncher' since there is already [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; fallback=false; factoryBeanName=batchConfig; factoryMethodName=jobLauncher; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [com/krungsri/ipassportbatch/config/BatchConfig.class]] bound.
2025-03-04T08:54:12.443+07:00  INFO 14968 --- [ipassportbatch] [main] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-03-04T08:54:12.454+07:00 ERROR 14968 --- [ipassportbatch] [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

The bean 'jobLauncher', defined in class path resource [org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration$SpringBootBatchConfiguration.class], could not be registered. A bean with that name has already been defined in class path resource [com/krungsri/ipassportbatch/config/BatchConfig.class] and overriding is disabled.

Action:

Consider renaming one of the beans or enabling overriding by setting spring.main.allow-bean-definition-overriding=true

2025-03-04T08:54:36.643+07:00  INFO 8520 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : Starting IpassportbatchApplication using Java 23.0.1 with PID 8520 (D:\Krungsri\ipassport-batch\target\classes started by User in D:\Krungsri\ipassport-batch)
2025-03-04T08:54:36.643+07:00  INFO 8520 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : No active profile set, falling back to 1 default profile: "default"
2025-03-04T08:54:37.008+07:00  INFO 8520 --- [ipassportbatch] [main] o.s.b.c.c.annotation.BatchRegistrar      : Bean jobLauncher already defined in the application context, skipping the registration of a jobLauncher
2025-03-04T08:54:37.008+07:00  INFO 8520 --- [ipassportbatch] [main] o.s.b.c.c.annotation.BatchRegistrar      : Finished Spring Batch infrastructure beans configuration in 3 ms.
2025-03-04T08:54:37.135+07:00  INFO 8520 --- [ipassportbatch] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-04T08:54:37.151+07:00  INFO 8520 --- [ipassportbatch] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 9 ms. Found 0 JPA repository interfaces.
2025-03-04T08:54:37.549+07:00  INFO 8520 --- [ipassportbatch] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-03-04T08:54:37.838+07:00  INFO 8520 --- [ipassportbatch] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: d619826b-b3fe-4827-8a49-6b3f901f7825
2025-03-04T08:54:37.844+07:00  INFO 8520 --- [ipassportbatch] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-03-04T08:54:37.902+07:00  INFO 8520 --- [ipassportbatch] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-04T08:54:37.944+07:00  INFO 8520 --- [ipassportbatch] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.8.Final
2025-03-04T08:54:37.982+07:00  INFO 8520 --- [ipassportbatch] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-03-04T08:54:38.218+07:00  INFO 8520 --- [ipassportbatch] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-04T08:54:38.268+07:00  WARN 8520 --- [ipassportbatch] [main] org.hibernate.orm.deprecation            : HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-03-04T08:54:38.268+07:00  INFO 8520 --- [ipassportbatch] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 16.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-03-04T08:54:38.550+07:00  INFO 8520 --- [ipassportbatch] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-03-04T08:54:38.550+07:00  INFO 8520 --- [ipassportbatch] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-04T08:54:38.597+07:00  INFO 8520 --- [ipassportbatch] [main] o.s.b.c.r.s.JobRepositoryFactoryBean     : No database type set, using meta data indicating: SQLSERVER
2025-03-04T08:54:38.629+07:00  INFO 8520 --- [ipassportbatch] [main] o.s.b.c.l.s.TaskExecutorJobLauncher      : No TaskExecutor has been set, defaulting to synchronous executor.
2025-03-04T08:54:38.672+07:00  INFO 8520 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:54:38.672+07:00  INFO 8520 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:54:38.678+07:00  INFO 8520 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:54:38.688+07:00  INFO 8520 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:54:38.696+07:00  INFO 8520 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:54:38.701+07:00  INFO 8520 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:54:38.701+07:00  INFO 8520 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:54:38.707+07:00  INFO 8520 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:54:38.712+07:00  INFO 8520 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:54:38.714+07:00  INFO 8520 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:54:38.716+07:00  INFO 8520 --- [ipassportbatch] [main] .c.a.BatchObservabilityBeanPostProcessor : No Micrometer observation registry found, defaulting to ObservationRegistry.NOOP
2025-03-04T08:54:38.897+07:00  INFO 8520 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : Started IpassportbatchApplication in 2.696 seconds (process running for 3.022)
2025-03-04T08:55:00.121+07:00 ERROR 8520 --- [ipassportbatch] [scheduling-1] o.s.s.s.TaskUtils$LoggingErrorHandler    : Unexpected error occurred in scheduled task

org.springframework.jdbc.UncategorizedSQLException: PreparedStatementCallback; uncategorized SQLException for SQL [SELECT JOB_INSTANCE_ID, JOB_NAME
FROM BATCH_JOB_INSTANCE
WHERE JOB_NAME = ?
 and JOB_KEY = ?]; SQL state [S0002]; error code [208]; Invalid object name 'BATCH_JOB_INSTANCE'.
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1557) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:677) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:723) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:754) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:767) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:825) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.batch.core.repository.dao.JdbcJobInstanceDao.getJobInstance(JdbcJobInstanceDao.java:183) ~[spring-batch-core-5.2.1.jar:5.2.1]
	at org.springframework.batch.core.repository.support.SimpleJobRepository.getLastJobExecution(SimpleJobRepository.java:299) ~[spring-batch-core-5.2.1.jar:5.2.1]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.3.jar:6.2.3]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.3.jar:6.2.3]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.3.jar:6.2.3]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380) ~[spring-tx-6.2.3.jar:6.2.3]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.2.3.jar:6.2.3]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.3.jar:6.2.3]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.3.jar:6.2.3]
	at jdk.proxy2/jdk.proxy2.$Proxy80.getLastJobExecution(Unknown Source) ~[na:na]
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109) ~[spring-batch-core-5.2.1.jar:5.2.1]
	at com.krungsri.ipassportbatch.scheduler.BatchScheduler.scheduleMarkExpiredTransaction(BatchScheduler.java:58) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124) ~[spring-context-6.2.3.jar:6.2.3]
	at io.micrometer.observation.Observation.observe(Observation.java:498) ~[micrometer-observation-1.14.4.jar:1.14.4]
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:96) ~[spring-context-6.2.3.jar:6.2.3]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1575) ~[na:na]
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: Invalid object name 'BATCH_JOB_INSTANCE'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:270) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1735) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.doExecutePreparedStatement(SQLServerPreparedStatement.java:675) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement$PrepStmtExecCmd.doExecute(SQLServerPreparedStatement.java:594) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4391) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:276) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:246) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.executeQuery(SQLServerPreparedStatement.java:509) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52) ~[HikariCP-5.1.0.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java) ~[HikariCP-5.1.0.jar:na]
	at org.springframework.jdbc.core.JdbcTemplate$1.doInPreparedStatement(JdbcTemplate.java:732) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:658) ~[spring-jdbc-6.2.3.jar:6.2.3]
	... 33 common frames omitted

2025-03-04T08:55:00.125+07:00 ERROR 8520 --- [ipassportbatch] [scheduling-1] o.s.s.s.TaskUtils$LoggingErrorHandler    : Unexpected error occurred in scheduled task

org.springframework.jdbc.UncategorizedSQLException: PreparedStatementCallback; uncategorized SQLException for SQL [SELECT JOB_INSTANCE_ID, JOB_NAME
FROM BATCH_JOB_INSTANCE
WHERE JOB_NAME = ?
 and JOB_KEY = ?]; SQL state [S0002]; error code [208]; Invalid object name 'BATCH_JOB_INSTANCE'.
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1557) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:677) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:723) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:754) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:767) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:825) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.batch.core.repository.dao.JdbcJobInstanceDao.getJobInstance(JdbcJobInstanceDao.java:183) ~[spring-batch-core-5.2.1.jar:5.2.1]
	at org.springframework.batch.core.repository.support.SimpleJobRepository.getLastJobExecution(SimpleJobRepository.java:299) ~[spring-batch-core-5.2.1.jar:5.2.1]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.3.jar:6.2.3]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.3.jar:6.2.3]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.3.jar:6.2.3]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380) ~[spring-tx-6.2.3.jar:6.2.3]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.2.3.jar:6.2.3]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.3.jar:6.2.3]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.3.jar:6.2.3]
	at jdk.proxy2/jdk.proxy2.$Proxy80.getLastJobExecution(Unknown Source) ~[na:na]
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109) ~[spring-batch-core-5.2.1.jar:5.2.1]
	at com.krungsri.ipassportbatch.scheduler.BatchScheduler.scheduleClearCustomerData(BatchScheduler.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124) ~[spring-context-6.2.3.jar:6.2.3]
	at io.micrometer.observation.Observation.observe(Observation.java:498) ~[micrometer-observation-1.14.4.jar:1.14.4]
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:96) ~[spring-context-6.2.3.jar:6.2.3]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1575) ~[na:na]
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: Invalid object name 'BATCH_JOB_INSTANCE'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:270) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1735) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.doExecutePreparedStatement(SQLServerPreparedStatement.java:675) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement$PrepStmtExecCmd.doExecute(SQLServerPreparedStatement.java:594) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4391) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:276) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:246) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.executeQuery(SQLServerPreparedStatement.java:509) ~[mssql-jdbc-12.8.1.jre11.jar:na]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52) ~[HikariCP-5.1.0.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java) ~[HikariCP-5.1.0.jar:na]
	at org.springframework.jdbc.core.JdbcTemplate$1.doInPreparedStatement(JdbcTemplate.java:732) ~[spring-jdbc-6.2.3.jar:6.2.3]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:658) ~[spring-jdbc-6.2.3.jar:6.2.3]
	... 33 common frames omitted

2025-03-04T08:55:17.690+07:00  INFO 8520 --- [ipassportbatch] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-04T08:55:17.690+07:00  INFO 8520 --- [ipassportbatch] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-03-04T08:55:17.697+07:00  INFO 8520 --- [ipassportbatch] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-03-04T08:56:07.905+07:00  INFO 16140 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : Starting IpassportbatchApplication using Java 23.0.1 with PID 16140 (D:\Krungsri\ipassport-batch\target\classes started by User in D:\Krungsri\ipassport-batch)
2025-03-04T08:56:07.905+07:00  INFO 16140 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : No active profile set, falling back to 1 default profile: "default"
2025-03-04T08:56:08.366+07:00  WARN 16140 --- [ipassportbatch] [main] s.c.a.AnnotationConfigApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.support.BeanDefinitionOverrideException: Invalid bean definition with name 'jobLauncher' defined in class path resource [org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration$SpringBootBatchConfiguration.class]: Cannot register bean definition [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; fallback=false; factoryBeanName=org.springframework.boot.autoconfigure.batch.BatchAutoConfiguration$SpringBootBatchConfiguration; factoryMethodName=jobLauncher; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration$SpringBootBatchConfiguration.class]] for bean 'jobLauncher' since there is already [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; fallback=false; factoryBeanName=batchConfig; factoryMethodName=jobLauncher; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [com/krungsri/ipassportbatch/config/BatchConfig.class]] bound.
2025-03-04T08:56:08.381+07:00  INFO 16140 --- [ipassportbatch] [main] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-03-04T08:56:08.398+07:00 ERROR 16140 --- [ipassportbatch] [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

The bean 'jobLauncher', defined in class path resource [org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration$SpringBootBatchConfiguration.class], could not be registered. A bean with that name has already been defined in class path resource [com/krungsri/ipassportbatch/config/BatchConfig.class] and overriding is disabled.

Action:

Consider renaming one of the beans or enabling overriding by setting spring.main.allow-bean-definition-overriding=true

2025-03-04T08:57:26.052+07:00  INFO 19272 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : Starting IpassportbatchApplication using Java 23.0.1 with PID 19272 (D:\Krungsri\ipassport-batch\target\classes started by User in D:\Krungsri\ipassport-batch)
2025-03-04T08:57:26.057+07:00  INFO 19272 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : No active profile set, falling back to 1 default profile: "default"
2025-03-04T08:57:26.534+07:00  INFO 19272 --- [ipassportbatch] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-04T08:57:26.558+07:00  INFO 19272 --- [ipassportbatch] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 11 ms. Found 0 JPA repository interfaces.
2025-03-04T08:57:26.904+07:00  INFO 19272 --- [ipassportbatch] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-03-04T08:57:27.221+07:00  INFO 19272 --- [ipassportbatch] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: 88442086-4509-42b0-8486-6aa81f430501
2025-03-04T08:57:27.221+07:00  INFO 19272 --- [ipassportbatch] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-03-04T08:57:27.373+07:00  INFO 19272 --- [ipassportbatch] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-04T08:57:27.418+07:00  INFO 19272 --- [ipassportbatch] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.8.Final
2025-03-04T08:57:27.460+07:00  INFO 19272 --- [ipassportbatch] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-03-04T08:57:27.678+07:00  INFO 19272 --- [ipassportbatch] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-04T08:57:27.735+07:00  WARN 19272 --- [ipassportbatch] [main] org.hibernate.orm.deprecation            : HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-03-04T08:57:27.744+07:00  INFO 19272 --- [ipassportbatch] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 16.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-03-04T08:57:28.002+07:00  INFO 19272 --- [ipassportbatch] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-03-04T08:57:28.008+07:00  INFO 19272 --- [ipassportbatch] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-04T08:57:28.220+07:00  WARN 19272 --- [ipassportbatch] [main] s.c.a.AnnotationConfigApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'jobLauncherApplicationRunner' defined in class path resource [org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration.class]: Job name must be specified in case of multiple jobs
2025-03-04T08:57:28.220+07:00  INFO 19272 --- [ipassportbatch] [main] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-04T08:57:28.228+07:00  INFO 19272 --- [ipassportbatch] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-03-04T08:57:28.234+07:00  INFO 19272 --- [ipassportbatch] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-03-04T08:57:28.245+07:00  INFO 19272 --- [ipassportbatch] [main] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-03-04T08:57:28.263+07:00 ERROR 19272 --- [ipassportbatch] [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'jobLauncherApplicationRunner' defined in class path resource [org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration.class]: Job name must be specified in case of multiple jobs
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1812) ~[spring-beans-6.2.3.jar:6.2.3]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601) ~[spring-beans-6.2.3.jar:6.2.3]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523) ~[spring-beans-6.2.3.jar:6.2.3]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339) ~[spring-beans-6.2.3.jar:6.2.3]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:346) ~[spring-beans-6.2.3.jar:6.2.3]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337) ~[spring-beans-6.2.3.jar:6.2.3]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202) ~[spring-beans-6.2.3.jar:6.2.3]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.instantiateSingleton(DefaultListableBeanFactory.java:1155) ~[spring-beans-6.2.3.jar:6.2.3]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingleton(DefaultListableBeanFactory.java:1121) ~[spring-beans-6.2.3.jar:6.2.3]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:1056) ~[spring-beans-6.2.3.jar:6.2.3]
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:987) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627) ~[spring-context-6.2.3.jar:6.2.3]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752) ~[spring-boot-3.4.3.jar:3.4.3]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439) ~[spring-boot-3.4.3.jar:3.4.3]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318) ~[spring-boot-3.4.3.jar:3.4.3]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361) ~[spring-boot-3.4.3.jar:3.4.3]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350) ~[spring-boot-3.4.3.jar:3.4.3]
	at com.krungsri.ipassportbatch.IpassportbatchApplication.main(IpassportbatchApplication.java:11) ~[classes/:na]
Caused by: java.lang.IllegalArgumentException: Job name must be specified in case of multiple jobs
	at org.springframework.util.Assert.isTrue(Assert.java:116) ~[spring-core-6.2.3.jar:6.2.3]
	at org.springframework.boot.autoconfigure.batch.JobLauncherApplicationRunner.afterPropertiesSet(JobLauncherApplicationRunner.java:115) ~[spring-boot-autoconfigure-3.4.3.jar:3.4.3]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1859) ~[spring-beans-6.2.3.jar:6.2.3]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1808) ~[spring-beans-6.2.3.jar:6.2.3]
	... 17 common frames omitted

2025-03-04T08:59:10.547+07:00  INFO 18100 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : Starting IpassportbatchApplication using Java 23.0.1 with PID 18100 (D:\Krungsri\ipassport-batch\target\classes started by User in D:\Krungsri\ipassport-batch)
2025-03-04T08:59:10.547+07:00  INFO 18100 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : No active profile set, falling back to 1 default profile: "default"
2025-03-04T08:59:11.053+07:00  INFO 18100 --- [ipassportbatch] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-04T08:59:11.070+07:00  INFO 18100 --- [ipassportbatch] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 10 ms. Found 0 JPA repository interfaces.
2025-03-04T08:59:11.421+07:00  INFO 18100 --- [ipassportbatch] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-03-04T08:59:11.750+07:00  INFO 18100 --- [ipassportbatch] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: 30c7946a-e4d6-4239-92a8-15a7727a2d81
2025-03-04T08:59:11.752+07:00  INFO 18100 --- [ipassportbatch] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-03-04T08:59:11.894+07:00  INFO 18100 --- [ipassportbatch] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-04T08:59:11.947+07:00  INFO 18100 --- [ipassportbatch] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.8.Final
2025-03-04T08:59:11.986+07:00  INFO 18100 --- [ipassportbatch] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-03-04T08:59:12.216+07:00  INFO 18100 --- [ipassportbatch] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-04T08:59:12.261+07:00  WARN 18100 --- [ipassportbatch] [main] org.hibernate.orm.deprecation            : HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-03-04T08:59:12.284+07:00  INFO 18100 --- [ipassportbatch] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 16.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-03-04T08:59:12.507+07:00  INFO 18100 --- [ipassportbatch] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-03-04T08:59:12.514+07:00  INFO 18100 --- [ipassportbatch] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-04T08:59:12.883+07:00  INFO 18100 --- [ipassportbatch] [main] c.k.i.IpassportbatchApplication          : Started IpassportbatchApplication in 2.802 seconds (process running for 3.149)
2025-03-04T09:00:00.122+07:00  INFO 18100 --- [ipassportbatch] [scheduling-1] o.s.b.c.l.s.TaskExecutorJobLauncher      : Job: [SimpleJob: [name=markExpireTransaction]] launched with the following parameters: [{}]
2025-03-04T09:00:00.186+07:00  INFO 18100 --- [ipassportbatch] [scheduling-1] o.s.batch.core.job.SimpleStepHandler     : Executing step: [markExpireStep]
2025-03-04T09:00:00.214+07:00  INFO 18100 --- [ipassportbatch] [scheduling-1] c.k.i.t.MarkExpireTransactionTasklet     : Updating Expire IPRO_TX_TRANSACTION table...
2025-03-04T09:00:00.220+07:00 ERROR 18100 --- [ipassportbatch] [scheduling-1] c.k.i.t.MarkExpireTransactionTasklet     : Updating IPRO_TX_TRANSACTION table unsuccess StatementCallback; uncategorized SQLException for SQL [EXEC sp_mark_expire]; SQL state [S0062]; error code [2812]; Could not find stored procedure 'sp_mark_expire'.
2025-03-04T09:00:00.305+07:00  INFO 18100 --- [ipassportbatch] [scheduling-1] o.s.batch.core.step.AbstractStep         : Step: [markExpireStep] executed in 118ms
2025-03-04T09:00:00.326+07:00  INFO 18100 --- [ipassportbatch] [scheduling-1] o.s.b.c.l.s.TaskExecutorJobLauncher      : Job: [SimpleJob: [name=markExpireTransaction]] completed with the following parameters: [{}] and the following status: [COMPLETED] in 191ms
2025-03-04T09:00:00.347+07:00  INFO 18100 --- [ipassportbatch] [scheduling-1] o.s.b.c.l.s.TaskExecutorJobLauncher      : Job: [SimpleJob: [name=clearCustomerData]] launched with the following parameters: [{}]
2025-03-04T09:00:00.375+07:00  INFO 18100 --- [ipassportbatch] [scheduling-1] o.s.batch.core.job.SimpleStepHandler     : Executing step: [markExpireBeforeClearStep]
2025-03-04T09:00:00.380+07:00  INFO 18100 --- [ipassportbatch] [scheduling-1] ExpireTransactionBeforeDailyClearTasklet : Updating Expire IPRO_TX_TRANSACTION table...
2025-03-04T09:00:00.381+07:00 ERROR 18100 --- [ipassportbatch] [scheduling-1] ExpireTransactionBeforeDailyClearTasklet : Updating IPRO_TX_TRANSACTION table unsuccess StatementCallback; uncategorized SQLException for SQL [EXEC sp_mark_expire_before_daily_clear]; SQL state [S0062]; error code [2812]; Could not find stored procedure 'sp_mark_expire_before_daily_clear'.
2025-03-04T09:00:00.385+07:00  INFO 18100 --- [ipassportbatch] [scheduling-1] o.s.batch.core.step.AbstractStep         : Step: [markExpireBeforeClearStep] executed in 9ms
2025-03-04T09:00:00.402+07:00  INFO 18100 --- [ipassportbatch] [scheduling-1] o.s.batch.core.job.SimpleStepHandler     : Executing step: [clearPassportIdStep]
2025-03-04T09:00:00.411+07:00  INFO 18100 --- [ipassportbatch] [scheduling-1] c.k.i.tasklet.ClearPassportIdTasklet     : Clearing IPRO_TX_PASSPORTID table...
2025-03-04T09:00:00.412+07:00 ERROR 18100 --- [ipassportbatch] [scheduling-1] c.k.i.tasklet.ClearPassportIdTasklet     : Clearing IPRO_TX_PASSPORTID table unsuccess StatementCallback; uncategorized SQLException for SQL [EXEC sp_clear_passportid]; SQL state [S0062]; error code [2812]; Could not find stored procedure 'sp_clear_passportid'.
2025-03-04T09:00:00.418+07:00  INFO 18100 --- [ipassportbatch] [scheduling-1] o.s.batch.core.step.AbstractStep         : Step: [clearPassportIdStep] executed in 16ms
2025-03-04T09:00:00.436+07:00  INFO 18100 --- [ipassportbatch] [scheduling-1] o.s.batch.core.job.SimpleStepHandler     : Executing step: [clearThaiIdStep]
2025-03-04T09:00:00.441+07:00  INFO 18100 --- [ipassportbatch] [scheduling-1] c.k.i.tasklet.ClearThaiIdTasklet         : Clearing IPRO_TX_THAIID table...
2025-03-04T09:00:00.443+07:00 ERROR 18100 --- [ipassportbatch] [scheduling-1] c.k.i.tasklet.ClearThaiIdTasklet         : Clearing IPRO_TX_THAIID table unsuccess StatementCallback; uncategorized SQLException for SQL [EXEC sp_clear_thaiid]; SQL state [S0062]; error code [2812]; Could not find stored procedure 'sp_clear_thaiid'.
2025-03-04T09:00:00.445+07:00  INFO 18100 --- [ipassportbatch] [scheduling-1] o.s.batch.core.step.AbstractStep         : Step: [clearThaiIdStep] executed in 8ms
2025-03-04T09:00:00.453+07:00  INFO 18100 --- [ipassportbatch] [scheduling-1] o.s.b.c.l.s.TaskExecutorJobLauncher      : Job: [SimpleJob: [name=clearCustomerData]] completed with the following parameters: [{}] and the following status: [COMPLETED] in 103ms
2025-03-04T09:00:15.960+07:00  INFO 18100 --- [ipassportbatch] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-04T09:00:15.962+07:00  INFO 18100 --- [ipassportbatch] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-03-04T09:00:15.966+07:00  INFO 18100 --- [ipassportbatch] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
